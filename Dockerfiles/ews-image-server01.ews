# [ews-image-server01.ews] Custom Ubuntu image for OTLab [01]
#  _____ _____ __        _   
# |     |_   _|  |   ___| |_ 
# |  |  | | | |  |__| .'| . |
# |_____| |_| |_____|__,|___|
#
# github.com/substationworm/OTLab
# Author: substationworm
# Contact: in/lffreitas-gutierres

FROM ubuntu:22.04

LABEL maintainer="substationworm (luiz.gutierres@ufsm.br)"
LABEL description="Custom Ubuntu image for OTLab [01]"

# Avoid interactive prompts during package installation
ENV DEBIAN_FRONTEND=noninteractive

# Update and install core packages
RUN apt update && apt upgrade -y && \
    apt install -y \
        iputils-ping \
        iproute2 \
        net-tools \
        tcpdump \
        nmap \
        openssh-server \
        apache2 \
        netcat-openbsd \
        nano \
        rsyslog \
        iptables && \
    rm -rf /var/lib/apt/lists/*

RUN mkdir -p /run/sshd /var/log/otlab

COPY Server01-Offline.sh /usr/local/bin/Server01-Offline.sh
RUN chmod +x /usr/local/bin/Server01-Offline.sh

ENTRYPOINT ["/usr/local/bin/Server01-Offline.sh"]